{% extends 'base.html' %} <!--Para usar el template llamado base.html-->

{% block content %}
<div class="container mx-auto py-10">
    <div class="flex flex-col md:flex-row gap-6">
        <div class="bg-white rounded-lg shadow-md p-6 flex flex-col items-center md:w-1/3">
            <img src="../media/{{ user_info.profile.pic }}" alt="User Profile Picture" class="rounded-full w-32 h-32 mb-4">
            <h2 class="text-[#0e141b] text-2xl font-bold mb-2">{{ user_info.username }}</h2>
            <p class="text-[#4e7397] text-base mb-4">{{ user_info.email }}</p>
            {% if user_info.profile %}
                <p class="text-[#0e141b] text-base">{{ user_info.profile.description }}</p>
            {% else %}
                <p class="text-[#0e141b] text-base">Aún no has completado tu perfil.</p>
                <a href="{% url 'complete_profile' %}" class="bg-[#1980e6] text-white font-bold py-2 px-4 rounded-lg mt-4">Completar perfil</a>
            {% endif %}
        </div>
        <div class="bg-white rounded-lg shadow-md p-6 flex-grow">
            <h3 class="text-[#0e141b] text-2xl font-bold mb-4">Listas creadas por {{ user_info.username }}</h3>
            <ul id="user-lists" class="space-y-4"></ul>
            <button id="load-more" class="bg-[#1980e6] text-white font-bold py-2 px-4 rounded-lg mt-4">Cargar más</button>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        let offset = 0;
        const limit = 10;
        const loadMoreButton = document.getElementById('load-more');
        const userListsContainer = document.getElementById('user-lists');

        function loadUserLists() {
            fetch(`{% url 'load_user_lists' user_info.username %}?offset=${offset}&limit=${limit}`)
                .then(response => response.json())
                .then(data => {
                    data.lists.forEach(list => {
                        const listItem = document.createElement('li');
                        listItem.className = 'bg-[#e7edf3] rounded-lg p-4 flex items-center space-x-4';
                        listItem.innerHTML = `<div class="flex-grow"><h5 class="text-lg font-bold text-[#0e141b]">${list.name}</h5></div>`;
                        userListsContainer.appendChild(listItem);
                    });
                    if (!data.has_more) {
                        loadMoreButton.style.display = 'none';
                    }
                    offset += limit;
                });
        }

        loadMoreButton.addEventListener('click', loadUserLists);
        loadUserLists();
    });
</script>
{% endblock %}